<div class="refs-ref">
  <div class="retainer retained">
    <div class="expander">

      <div class="show-ref-details">

        <div class="ref-top">
          <!-- Delete and edit buttons -->

          <span class="show-saved">saved</span>

          <div class="centering pull-right right-buttons">
            <button class="click-start-edit btn btn-default btn-xs"><span class="glyphicon glyphicon-edit"></span> edit</button>
            <div class="clearfix"></div>
            <button ng-click="confirm_delete()" class="btn btn-default btn-xs pull-right">
              <span class="glyphicon glyphicon-fire"></span> delete
            </button>
            <div class="clearfix"></div>
          </div>

          <!-- Title -->
          <span class="show-title">{{::thisref.title}}</span>
          <span class="show-ref_type">{{::thisref.ref_type}}</span>
          <div class="clearfix"></div>
        </div>

        <div class="ref-middle">

          <!-- Most other details -->
          <span class="show-author">{{::thisref.author}}</span>
          <span class="show-booktitle">{{::thisref.booktitle}}</span>
          <span class="show-year">{{::thisref.year}}</span>
          <span class="show-citation_key">{{::thisref.citation_key}}</span>
          <span class="show-url"><a target="_blank" href="{{::thisref.url}}">{{::thisref.url}}</a></span>

          <!-- Labels -->
          <div class="labels-wrapper">
            <labelpicker labelchanged="update_label" pickerid="thisref._id" activelabels="activelabels"></labelpicker>
            <span class="label label-default" ng-repeat="label in thisref.labels track by label._id">{{::label.name}}</span>
          </div>
          <filebunch changed="save_ref" files="thisref.files" class="files" formdata="{ref_id:thisref._id}"></filebunch>
          <div class="clearfix"></div>

        </div>
      </div>

      <div class="ref-form">
        <div class="ref-top">
          <div class="pull-right right-buttons">
            <button class="click-cancel-edit btn btn-default btn-xs"><span class="glyphicon glyphicon-chevron-left"></span> cancel</button>
            <button class="click-save-edit btn btn-default btn-xs"><span class="glyphicon glyphicon-save"></span> save</button>
            <div class="clearfix"></div>
          </div>
          <div><label class="form">title: </label><input class="form-title" ></div>
          <div><label class="form">ref type: </label><reftype ></reftype></div>

          <div class="clearfix"></div>
        </div>

        <div class="ref-middle">

          <div><label class="form">author: </label><input class="form-author"></div>
          <div><label class="form">book title: </label><input class="form-booktitle"></div>
          <div><label class="form">year: </label><input class="form-year"></div>
          <div><label class="form">cite key: </label><input class="form-citation_key"></div>
          <div><label class="form">url: </label><input class="form-url"></div>

        </div>

      </div>


      <div class="ref-bottom">
        <textarea class="autogrow notes" ng-keyup="notes_changed()" placeholder="your notes">{{::thisref.notes}}</textarea>
      </div>

    </div><!-- end of expander -->

    <div class="expand click-toggle-retained">
      <span class="retain-glyph">&#x25BF;</span>
    </div>

  </div><!-- endo of retainer -->
</div>
